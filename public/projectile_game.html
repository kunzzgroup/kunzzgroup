<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Strategy Card Prototype</title>
  <style>
    body { margin: 0; background:#0f1220; color:#eaeaf0; font-family: system-ui, -apple-system, Segoe UI, Roboto; }
    #app { display:flex; height:100vh; }
    .panel { padding:16px; box-sizing:border-box; }
    #left { width:260px; background:#151936; }
    #center { flex:1; background:#0f1220; }
    #right { width:320px; background:#151936; }
    .card { border:1px solid #3a3f7a; border-radius:8px; padding:8px; margin:6px 0; cursor:pointer; background:#1b2050; }
    .card:hover { background:#23297a; }
    .btn { padding:8px 12px; border-radius:6px; border:1px solid #3a3f7a; background:#1b2050; color:#fff; cursor:pointer; }
    .btn:disabled { opacity:.5; cursor:not-allowed; }
    .row { display:flex; gap:8px; }
    .stat { font-size:14px; margin:4px 0; }
    h3 { margin:0 0 8px 0; }
  </style>
</head>
<body>
<div id="app">
  <div id="left" class="panel">
    <h3>Player</h3>
    <div class="stat">HP: <span id="php"></span></div>
    <div class="stat">Energy: <span id="energy"></span></div>
    <div class="stat">Gold: <span id="gold"></span></div>
    <h3>Hand</h3>
    <div id="hand"></div>
    <div class="row">
      <button class="btn" id="endTurn">End Turn</button>
      <button class="btn" id="save">Save</button>
      <button class="btn" id="load">Load</button>
    </div>
  </div>
  <div id="center" class="panel">
    <h3>Battle Log</h3>
    <div id="log"></div>
  </div>
  <div id="right" class="panel">
    <h3>Enemy</h3>
    <div class="stat">HP: <span id="ehp"></span></div>
    <div class="stat">Intent: <span id="intent"></span></div>
  </div>
</div>

<script>
// --- Core Data ---
const cardsDB = {
  strike: { id:'strike', name:'Strike', cost:1, type:'attack', value:6 },
  defend: { id:'defend', name:'Defend', cost:1, type:'block', value:5 },
  bash: { id:'bash', name:'Bash', cost:2, type:'attack', value:10 }
};

let state = {
  player: { hp: 60, energy: 3, gold: 50, block: 0 },
  enemy: { hp: 45, intent: 'attack', damage: 8 },
  deck: ['strike','strike','strike','defend','defend','bash'],
  hand: [],
  discard: [],
  turn: 1
};

// --- Utilities ---
const $ = id => document.getElementById(id);
const log = msg => { const d=document.createElement('div'); d.textContent=msg; $('log').prepend(d); };
const shuffle = a => a.sort(()=>Math.random()-0.5);

// --- Game Flow ---
function draw(n=5){
  for(let i=0;i<n;i++){
    if(!state.deck.length){ state.deck = shuffle(state.discard); state.discard=[]; }
    if(state.deck.length) state.hand.push(state.deck.pop());
  }
}

function startTurn(){
  state.player.energy = 3;
  state.player.block = 0;
  draw(5);
  render();
}

function playCard(idx){
  const id = state.hand[idx];
  const c = cardsDB[id];
  if(c.cost > state.player.energy) return;
  state.player.energy -= c.cost;
  if(c.type==='attack'){
    state.enemy.hp -= c.value;
    log(`You used ${c.name} for ${c.value}`);
  } else if(c.type==='block'){
    state.player.block += c.value;
    log(`You gained ${c.value} Block`);
  }
  state.discard.push(state.hand.splice(idx,1)[0]);
  checkEnemy();
  render();
}

function endTurn(){
  // Enemy action
  if(state.enemy.intent==='attack'){
    const dmg = Math.max(0, state.enemy.damage - state.player.block);
    state.player.hp -= dmg;
    log(`Enemy attacks for ${state.enemy.damage} (${dmg} taken)`);
  }
  state.hand.forEach(c=>state.discard.push(c));
  state.hand=[];
  state.turn++;
  startTurn();
}

function checkEnemy(){
  if(state.enemy.hp<=0){
    log('Enemy defeated! +20 gold');
    state.player.gold += 20;
    // new enemy
    state.enemy = { hp: 50+state.turn*5, intent:'attack', damage:8+state.turn };
  }
}

// --- Persistence ---
$('save').onclick = ()=> localStorage.setItem('card-proto', JSON.stringify(state));
$('load').onclick = ()=>{ const s=localStorage.getItem('card-proto'); if(s){ state=JSON.parse(s); render(); } };
$('endTurn').onclick = endTurn;

// --- Render ---
function render(){
  $('php').textContent = state.player.hp;
  $('energy').textContent = state.player.energy;
  $('gold').textContent = state.player.gold;
  $('ehp').textContent = state.enemy.hp;
  $('intent').textContent = state.enemy.intent;
  $('hand').innerHTML='';
  state.hand.forEach((id,i)=>{
    const c=cardsDB[id];
    const d=document.createElement('div');
    d.className='card';
    d.innerHTML=`<b>${c.name}</b><br/>Cost: ${c.cost}<br/>${c.type==='attack'?'Damage':'Block'}: ${c.value}`;
    d.onclick=()=>playCard(i);
    $('hand').appendChild(d);
  });
}

// --- Boot ---
shuffle(state.deck);
startTurn();
</script>
</body>
</html>